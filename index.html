<!doctype html><html lang="en"><head><meta charset="utf-8"><title>advice.land</title><meta name="description" content="advice.land !"><meta property="og:image" content="https://advice.land/img/sample-icon.png"><meta property="og:title" content="advice.land"><meta property="og:description" content="advice.land !"><meta property="og:type" content="website"><meta property="og:url" content="https://advice.land"><meta property="og:locale" content="en_US"><link rel="manifest" href="manifest.json"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><meta name="viewport" content="width=device-width,initial-scale=1"><style>a,abbr,acronym,address,article,aside,b,big,blockquote,body,caption,cite,code,dd,del,dfn,div,dl,dt,em,fieldset,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,nav,object,ol,p,pre,q,samp,section,small,span,strike,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,tt,ul,var{margin:0;padding:0;border:0;outline:0;font-size:100%;font:inherit;vertical-align:baseline}body{line-height:1;background-color:#fff;color:#fff;font-family:Arial,Helvetica,sans-serif;text-align:center;font-size:15pt;width:100%;overflow:hidden;overflow-y:auto}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:'';content:none}a:hover,ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}a{transition:.2s ease-in-out;color:inherit;text-decoration:none}ul{margin:0}b,strong{font-weight:700}i{font-style:italic}button,button:hover,input:focus,input[type=checkcbox]:focus,input[type=submit]:hover,select:focus,textarea:focus{background:0 0;border:0;padding:0;outline:0;line-height:normal;overflow:visible}h1{font-size:19pt}h2{font-size:17pt}p{font-size:15pt}.click-button{cursor:pointer;position:relative;top:0;left:0;display:inline-block;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.click-button::after{content:"";width:100%;height:100%;position:absolute;top:0;left:0;border-radius:12px;display:inline-block;transform:scaleX(1.2) scaleY(1.2);opacity:0;transition:opacity .3s,transform .3s;background:#fff}.click-button:active::after{transform:scaleX(0) scaleY(0);opacity:.8;transition:opacity,transform}.click-button:disabled{color:#888;background-color:#eee;filter:grayscale(100%)}#hidden-templates,.click-button:disabled::after{display:none}#chatframe.here{transform:translateX(0)}#chatframe{position:fixed;z-index:50;top:0;left:0;width:100%;height:100vh;padding:100px 15px 50px;box-sizing:border-box;transform:translateX(-102%);background:#333;transition:transform .3s}#my-video-streams-block{display:flex;position:absolute;bottom:100px;right:0;width:320px;height:160px;background-color:transparent}#desktop-capture-block,#web-cam-block{width:160px;height:160px;background-color:transparent}#incoming-video-streams-block{width:100%;height:calc(100vh - 200px);background-color:#0091ea;border-radius:30px;overflow:hidden}#chat-input-block{position:absolute;bottom:30px;left:50%;transform:translateX(-50%);width:100%}#chat-input-block input{padding:10px;box-sizing:border-box;background-color:rgba(68,68,68,.333);text-align:left;width:100%;border:none;font-size:13pt;color:#fff}#chat-input-block input:focus{background-color:rgba(68,68,68,.6);border:none}#peer-display-block{position:absolute;top:110px;right:0}#peer-display-block .peer-display-element{margin-bottom:10px;padding:10px;width:280px;background-color:rgba(68,68,68,.6);display:flex;justify-content:space-around;align-items:center}#peer-display-block .peer-display-element svg{width:30px;height:30px}#peer-display-block .peer-display-element .peer-name-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}#peer-display-block .peer-display-element .peer-call-button,#peer-display-block .peer-display-element .peer-video-button{padding:5px}#peer-display-block .peer-display-element .click-button[disabled]{pointer-events:none;color:grey;opacity:.5}#peer-display-block .peer-display-element.self{background-color:rgba(68,136,68,.6)}#chat-history-block{position:absolute;display:flex;flex-direction:column-reverse;top:0;left:15px;width:280px;height:100vh;background-color:rgba(68,68,68,.267)}#chat-history-block .chat-element{margin-bottom:7px;padding:5px;font-size:12pt;letter-spacing:.8pt;line-height:120%}#chat-history-block .chat-text{text-align:left;color:#fff}#chat-history-block .chat-time{text-align:right;padding:3px;font-size:7pt;color:#a9a9a9}@media screen and (min-width:600px){#chat-history-block{left:250px!important}#chat-input-block{width:50%;left:40%;transform:none}#my-video-streams-block{right:120px;width:540px;height:270px}#desktop-capture-block,#web-cam-block{width:270px;height:270px}}#footer{width:100%;height:100vh;padding:10px 20px;box-sizing:border-box;background-color:#d1b576;color:#0d1117;text-align:right}#header{display:flex;justify-content:space-between;align-items:center;position:fixed;z-index:99;width:100%;padding:10px 20px;box-sizing:border-box;background-color:rgba(209,181,118,.7);text-align:right}#chat-button{padding:5px}#chat-button svg{width:40px;height:40px}#queryfield{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;align-items:center;min-width:280px;width:calc(100% - 40px);max-width:1280px;box-sizing:border-box;background-color:rgba(13,17,23,.7);border:2px solid #d1b576;border-radius:30px;overflow:hidden}#queryfield input{font-size:15pt;text-overflow:ellipsis;padding:7px 14px;box-sizing:border-box;width:100%;color:#fff;background-color:transparent;text-align:center;border:none}#queryfield input:focus{padding:7px 20px}#queryfield #query-button{padding:10px;background-color:rgba(13,17,23,.8);color:#d1b576}#queryfield #query-button svg{width:20px;height:20px}#svgicon-symbols{display:none}#svgicon-definitions{position:absolute;height:0;width:0;bottom:0;right:0}#hero-section{width:100%;height:80vh;background-image:url(img/hero1.jpg);background-size:cover;background-repeat:no-repeat;background-position:center;position:relative;border-bottom:30px solid #d1b576}#recommendation-section{max-width:1280px;box-sizing:border-box;width:calc(100% - 20px);margin:auto;padding:210px 10px;display:grid;grid-template-columns:1fr;grid-row-gap:90px;grid-column-gap:30px}#recommendation-section .article-preview{position:relative;background-color:#fff;height:240px;border-bottom:30px solid #d1b576;filter:drop-shadow(1px 1px 2px #d1b576);background-image:url(img/hero1.jpg);background-size:cover;background-repeat:no-repeat;background-position:center}#recommendation-section .article-preview h2{position:absolute;top:calc(50% + 15px);left:50%;transform:translate(-50%,-50%);color:#fff;padding:20px;width:100%;box-sizing:border-box;background-color:rgba(65,91,78,.4)}#recommendation-section #entry1.article-preview{background-image:url(img/coffee-2.jpg)}#recommendation-section #entry2.article-preview{background-image:url(img/coffee-not-coffee.jpg)}@media screen and (min-width:640px){#recommendation-section{grid-template-columns:1fr 1fr}}@media screen and (min-width:960px){#recommendation-section{grid-template-columns:1fr 1fr 1fr}}#intermediate-layer{z-index:1;width:100%;position:absolute;top:0;left:0}</style></head><body><svg id="svgicon-definitions"><defs><filter id="svg-dropshadow-filter" height="130%" width="130%"><fegaussianblur in="SourceGraphic" stddeviation="3" result="blurOut"></fegaussianblur><feColorMatrix in="blurOut" type="saturate" values="0.25" result="shadowOut"></feColorMatrix><feblend in="SourceGraphic" in2="shadowOut" mode="normal"></feblend></filter></defs></svg> <svg id="svgicon-symbols"><symbol id="svg-cross-icon" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path fill="currentColor" d="M19,3H16.3H7.7H5A2,2 0 0,0 3,5V7.7V16.4V19A2,2 0 0,0 5,21H7.7H16.4H19A2,2 0 0,0 21,19V16.3V7.7V5A2,2 0 0,0 19,3M15.6,17L12,13.4L8.4,17L7,15.6L10.6,12L7,8.4L8.4,7L12,10.6L15.6,7L17,8.4L13.4,12L17,15.6L15.6,17Z"></path></symbol><symbol id="svg-menu-icon" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"></path></symbol><symbol id="svg-query-icon" preserveAspectRatio="xMidYMid meet" viewbox="0 0 24 24"><path fill="currentColor" d="M3 21V17H10.5C12.43 17 14 15.43 14 13.5V11H10L16 4L22 11H18V13.5C18 17.64 14.64 21 10.5 21H3Z"></path></symbol><symbol id="svg-phone-icon" preserveAspectRatio="xMidYMid meet" viewbox="0 0 24 24"><path fill="currentColor" d="M6.62,10.79C8.06,13.62 10.38,15.94 13.21,17.38L15.41,15.18C15.69,14.9 16.08,14.82 16.43,14.93C17.55,15.3 18.75,15.5 20,15.5A1,1 0 0,1 21,16.5V20A1,1 0 0,1 20,21A17,17 0 0,1 3,4A1,1 0 0,1 4,3H7.5A1,1 0 0,1 8.5,4C8.5,5.25 8.7,6.45 9.07,7.57C9.18,7.92 9.1,8.31 8.82,8.59L6.62,10.79Z"></path></symbol><symbol id="svg-cam-icon" preserveAspectRatio="xMidYMid meet" viewbox="0 0 24 24"><path fill="currentColor" d="M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z"></path></symbol><symbol id="svg-chat-icon" preserveAspectRatio="xMidYMid meet" viewbox="0 0 24 24"><path fill="currentColor" d="M12,3C17.5,3 22,6.58 22,11C22,15.42 17.5,19 12,19C10.76,19 9.57,18.82 8.47,18.5C5.55,21 2,21 2,21C4.33,18.67 4.7,17.1 4.75,16.5C3.05,15.07 2,13.13 2,11C2,6.58 6.5,3 12,3Z"></path></symbol></svg><div id="hidden-templates"><div id="peer-display-template"><li class="peer-display-element" uuid="{{{uuid}}}"><div class="peer-name-display">{{{uuid}}}</div><div class="peer-call-button click-button" disabled="disabled"><svg><use href="#svg-phone-icon"></use></svg></div><div class="peer-video-button click-button"><svg><use href="#svg-cam-icon"></use></svg></div></li></div><div id="chat-element-template"><li class="chat-element"><div class="chat-text">{{{text}}}</div><div class="chat-time">{{{time}}}</div></li></div></div><div id="chatframe"><video id="incoming-video-streams-block" autoplay></video><div id="my-video-streams-block"><video id="desktop-capture-block" muted autoplay></video><video id="web-cam-block" muted autoplay></video></div><ul id="chat-history-block"></ul><ul id="peer-display-block"></ul><div id="chat-input-block"><input id="chat-input"></div></div><header><div id="header"><a class="click-button" id="chat-button" href="#chat"><svg><use href="#svg-chat-icon"></use></svg></a><h1><a href="/#top">advice.land</a></h1></div></header><main><div id="hero-section"><div id="queryfield"><input id="query-input"><div class="click-button" id="query-button"><svg><use href="#svg-query-icon"></use></svg></div></div></div><div id="recommendation-section"><a class="article-preview" id="entry1" href="/article1.html"><h2>Sample advice Land Article</h2></a><a class="article-preview" id="entry2" href="/article2.html"><h2>The world is not black and white.<br><br>It is coffee and not coffee.</h2></a><a class="article-preview" id="entry3" href="/article3.html"><h2>Article 3</h2></a><a class="article-preview" id="entry4" href="/article4.html"><h2>Article 4</h2></a><a class="article-preview" id="entry5" href="/article5.html"><h2>Article 5</h2></a><a class="article-preview" id="entry6" href="/article6.html"><h2>Article 6</h2></a><a class="article-preview" id="entry7" href="/article7.html"><h2>Article 7</h2></a><a class="article-preview" id="entry8" href="/article8.html"><h2>Article 8</h2></a><a class="article-preview" id="entry9" href="/article9.html"><h2>Article 9 multi line Article with multiple Lines in the title</h2></a></div></main><footer><div id="footer"></div></footer><script>(()=>{var n={353:(e,t,n)=>{"use strict";n.r(t),n.d(t,{nickName:()=>o});var o="JhonnyJason"},62:function(t,e,n){!function(){var e={name:"indexdomconnect",initialize:function(){n.g.peerDisplayTemplate=document.getElementById("peer-display-template"),n.g.chatElementTemplate=document.getElementById("chat-element-template"),n.g.chatframe=document.getElementById("chatframe"),n.g.incomingVideoStreamsBlock=document.getElementById("incoming-video-streams-block"),n.g.desktopCaptureBlock=document.getElementById("desktop-capture-block"),n.g.webCamBlock=document.getElementById("web-cam-block"),n.g.chatHistoryBlock=document.getElementById("chat-history-block"),n.g.peerDisplayBlock=document.getElementById("peer-display-block"),n.g.chatInput=document.getElementById("chat-input")}};t.exports=e}.call(this)},981:function(b,e,U){!function(){var r,n,o,c,s,a,i,l,u,d,t,p,e,f,h,g,v={name:"statemodule"},m=function(e){null!=allModules.debugmodule.modulesToDebug.statemodule&&console.log("[statemodule]: "+e)},y=function(e){return JSON.stringify(e,null,4)},w=function(e){return m("\n"+y(e))};try{l=U(353)}catch(e){}g=null,r={},d={},a={},p=function(){var e,t;for(t in g=null!=(g=localStorage.getItem("state"))?JSON.parse(g):{})null==(e=g[t])&&(e=null),null!=e&&null!=e.content||(g[t]={content:e}),r[t]=g[t];for(t in l)e=l[t],null==r[t]&&(r[t]={content:e,isVolatile:!0})},u=function(e,t){return e!==t},s=function(e,t){var n=a[e]||u;return null==r[e]||(r[e].content,n(r[e].content,t))},t=function(e){var t;return m("loadDedicated"),t=localStorage.getItem(e),t=JSON.parse(t),r[e]={content:t,isDedicated:!0},t},f=function(e){var t;m("saveDedicatedState"),m(e),w({allStates:r}),t=r[e].content,r[e].isDedicated=!0,t=JSON.stringify(t),localStorage.setItem(e,t)},h=function(){var e;m("saveRegularState"),e=JSON.stringify(g),localStorage.setItem("state",e)},o=function(e,t,n,o){var a,i=null!=r[e]&&r[e].isVolatile;if("boolean"!=typeof n&&(n=null!=r[e]&&!0===r[e].isDedicated),null!=r[e]){if(a=r[e].isDedicated?n!==r[e].isDedicated:n,!(s(e,t)||i||a))return;r[e].content=t,n&&(r[e].isDedicated=!0),a&&!n&&(localStorage.removeItem(e),delete r[e].isDedicated),i&&delete r[e].isVolatile}else r[e]={content:t,isDedicated:n};if(n?(f(e),null!=g[e]&&(delete g[e],h())):(null==g[e]&&(g[e]=r[e]),h()),!o)return c(e)},e=function(){for(var e in m("saveAllStates"),w(r),r)r[e].isDedicated&&f(e);h()},n=function(e,t,n){if(s(e,t)){try{r[e].content=t}catch(n){r[e]={content:t,isVolatile:!0}}if(!n)return c(e)}},i=function(e){var t;if(1!==(t=Object.keys(e)).length)throw new Error("Object did not have exactly one Member!");return{key:t=t[0],content:e[t]}},c=async function(a){var i,e;if(null!=d[a])return e=function(){for(var e,t=[],n=0,o=(e=d[a]).length;n<o;n++)i=e[n],t.push(i());return t}(),Promise.all(e)},v.getState=function(){return r},v.load=function(e){return m("statemodule.load"),w({allStates:r}),null!=r[e]&&r[e].isVolatile?r[e].content:null==r[e]||r[e].isDedicated?t(e):(p(),r[e].content)},v.save=function(e,t,n){if(m("statemodule.save"),null!=e)return"object"==typeof e&&({key:e,content:t}=i(e)),null==t&&null==n?f(e):o(e,t,n,!1)},v.saveSilently=function(e,t,n){return m("statemodule.saveSilently"),"object"==typeof e&&({key:e,content:t}=i(e)),o(e,t,n,!0)},v.saveAll=e,v.saveRegularState=h,v.remove=function(e){if(m("statemodule.remove"),null!=r[e])if(r[e].isVolatile)delete r[e];else{if(r[e].isDedicated)return localStorage.removeItem(e),void delete r[e];delete r[e],delete g[e],h()}},v.get=function(e){if(null!=r[e])return r[e].content},v.set=function(e,t){m("statemodule.set"),"object"==typeof e&&({key:e,content:t}=i(e)),n(e,t,!1)},v.setSilently=function(e,t){m("statemodule.setSilently"),"object"==typeof e&&({key:e,content:t}=i(e)),n(e,t,!0)},v.addOnChangeListener=function(e,t){m("statemodule.addOnChangeListener"),null==d[e]&&(d[e]=[]),d[e].push(t)},v.removeOnChangeListener=function(e,t){var n,o,a,i;if(m("statemodule.removeOnChangeListener"),null!=(n=d[e])){for(o=a=0,i=n.length;a<i;o=++a)if(n[o]===t)return m("candidate found at: "+o),n[o]=n[n.length-1],void n.pop();m("No candidate found for given function!")}},v.clearOnChangeListeners=function(e,t){m("statemodule.clearOnChangeListener"),d[e]=[]},v.callOutChange=function(e){return c(e)},v.setChangeDetectionFunction=function(e,t){null==t?delete a[e]:a[e]=t},p(),b.exports=v}.call(this)}},o={};function Ge(e){var t=o[e];if(void 0!==t)return t.exports;t=o[e]={exports:{}};return n[e].call(t.exports,t,t.exports,Ge),t.exports}Ge.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return Ge.d(t,{a:t}),t},Ge.d=(e,t)=>{for(var n in t)Ge.o(t,n)&&!Ge.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},Ge.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),Ge.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Ge.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={},t=(Ge.r(e),Ge.d(e,{startUp:()=>H}),{}),n=(Ge.r(t),Ge.d(t,{appId:()=>q,defaultChannelId:()=>Z,p2pBootstrapPeers:()=>$,p2pWRTCStarServers:()=>_,reconnectTimeoutMS:()=>Q,websocketURL:()=>W}),{}),o=(Ge.r(n),Ge.d(n,{connect:()=>ae,disconnect:()=>ie,getUUID:()=>C,initialize:()=>F,sendMessage:()=>U}),{}),a=(Ge.r(o),Ge.d(o,{handleSDP:()=>ve,initialize:()=>re,initiateConnection:()=>D}),{}),i=(Ge.r(a),Ge.d(a,{addChatMessage:()=>Ze,displayPeers:()=>qe,initialize:()=>Re}),{});Ge.r(i),Ge.d(i,{modulesToDebug:()=>$e});function r(t){var n;return{log:n=function(e){V[t]&&console.log("["+t+"]: "+e)},olog:function(e){return n("\n"+J(e))}}}var N,P,c={},J=(Ge.r(c),Ge.d(c,{initialize:()=>Fe}),function(e){return JSON.stringify(e,null,4)}),V={};({log:N,olog:P}=r("appstartupmodule"));var s,l,A,u,d,p,f,h,g,v,z,m,y,w,H=function(){N("startUp")},W="wss://signalling-star.advice.land",Q=200,q="p2p-chat-demo",Z="#1",$=["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt"],_=["/dns4/wrtc-star1.par.dwebops.pub/tcp/443/wss/p2p-webrtc-star"],b=Ge(981),F=({log:u,olog:d}=r("websocketmodule"),l=!(p=!1),function(){u("initialize"),s=b.load("UUID"),d({UUID:s}),s=s||crypto.randomUUID(),b.save({UUID:s})}),X=function(e){u("websocketCaughtError"),d(e),u(e.reason)},G=function(e){l||p||(p=!0,setTimeout(ne,Q))},K=function(e){u("websocketConnected"),null!=g&&(g(),g=null),U("setuuid "+s)},Y=function(e){var t,n,o;switch(u("websocketMessageReceived"),u(e.data),(o=e.data.indexOf(" "))<0?n=e.data.trim():(n=e.data.substring(0,o),t=e.data.substring(o).trim()),n){case"alluids":ee(t);break;case"chat":te(t);break;case"sdp":ve(t);break;default:u("unknown key "+n)}},ee=function(e){u("applyAllUUIDS"),A=e.split(","),qe(A)},te=function(e){u("handleChat"),u(e),Ze(e)},ne=function(){p=!1,oe()},oe=function(){u("createSocket"),"undefined"!=typeof webSocketReady&&null!==webSocketReady||(h=new Promise(function(e,t){return g=e})),(f=new WebSocket(W)).onerror=X,f.onclose=G,f.onopen=K,f.onmessage=Y},U=async function(e){u("sendMessage "+e),l||(await h,f.send(e))},ae=function(){l=!1,oe()},ie=function(){null!==f&&(l=!0,f.close(),f=null)},C=function(){return s},re=({log:v,olog:z}=r("webrtcmodule"),w={},y={},m=s=g=h=f=null,function(){v("initialize")}),ce=async function(e){var t,n,o,a,i,r,c,s,l,u;v("initiateConnectionForVideo"),o=k(),(w[e]=o).adviceLandType="outConnection",o.adviceLandUUID=e,a={audio:!(webCamBlock.src="")};try{for(u=(m=null==m?await navigator.mediaDevices.getUserMedia(a):m).getTracks(),r=0,c=u.length;r<c;r++)l=u[r],o.addTrack(l,m);s=await o.createOffer(),i=new RTCSessionDescription(s),await o.setLocalDescription(i),t={type:"audio-offer",sourceUUID:C(),targetUUID:e,offerObj:s},n=JSON.stringify(t),U(`sdp ${e} `+n)}catch(e){v(e)}},se=async function(e){var t,n,o,a,i,r,c,s,l,u;v("initiateConnectionForVideo"),o=k(),(w[e]=o).adviceLandType="outConnection",o.adviceLandUUID=e,a={video:!0,audio:!0};try{for(null==m&&(m=await navigator.mediaDevices.getUserMedia(a),webCamBlock.srcObject=m),u=m.getTracks(),r=0,c=u.length;r<c;r++)l=u[r],o.addTrack(l,m);s=await o.createOffer(),i=new RTCSessionDescription(s),await o.setLocalDescription(i),t={type:"video-offer",sourceUUID:C(),targetUUID:e,offerObj:s},n=JSON.stringify(t),U(`sdp ${e} `+n)}catch(e){v(e)}},k=function(){var e;return v("createRTCPeerConnection"),(e=new RTCPeerConnection({iceServers:[{urls:"turn:stun.advice.land",username:"usr",credential:"cred"}]})).onicecandidate=le,e.ontrack=ue,e.onnegotiationneeded=de,e.onremovetrack=pe,e.oniceconnectionstatechange=fe,e.onicegatheringstatechange=he,e.onsignalingstatechange=ge,e},le=function(e){var t,n;v("handleICECandidateEvent"),z(e.candidate),v(e.target.adviceLandType),v(e.target.adviceLandUUID),null!=e.candidate&&(t=e.candidate,n=e.target.adviceLandType,e=e.target.adviceLandUUID,t={type:"ice-candidate",candidate:t},"outConnection"===n?(t.sourceUUID=C(),t.targetUUID=e,t.youAreTarget=!0):"inConnection"===n&&(t.sourceUUID=e,t.targetUUID=C()),n=JSON.stringify(t),U(`sdp ${e} `+n))},ue=function(e){v("handleTrackEvent"),incomingVideoStreamsBlock.srcObject=event.streams[0]},de=function(e){v("handleNegotiationNeededEvent")},pe=function(e){v("handleRemoveTrackEvent")},fe=function(e){v("handleICEConnectionStateChangeEvent")},he=function(e){v("handleICEGatheringStateChangeEvent")},ge=function(e){v("handleSignalingStateChangeEvent")},ve=async function(e){var t,n,o,a,i,r,c,s,l,u,d,p,f,h,g;v("handleSDP");try{if("video-offer"===(o=JSON.parse(e)).type){for(v("video-offer received"),r={video:!0,audio:!0},p=o.sourceUUID,i=k(),(y[p]=i).adviceLandType="inConnection",i.adviceLandUUID=p,c=new RTCSessionDescription(o.offerObj),await i.setRemoteDescription(c),null==m&&(m=await navigator.mediaDevices.getUserMedia(r),webCamBlock.srcObject=m),g=m.getTracks(),s=0,u=g.length;s<u;s++)h=g[s],i.addTrack(h,m);t=await i.createAnswer(),c=new RTCSessionDescription(t),await i.setLocalDescription(c),o={type:"video-answer",sourceUUID:o.sourceUUID,targetUUID:o.targetUUID,answerObj:t},a=JSON.stringify(o),U(`sdp ${p} `+a)}if("call-offer"===o.type){for(v("call-offer received"),r={audio:!0},p=o.sourceUUID,i=k(),(y[p]=i).adviceLandType="inConnection",i.adviceLandUUID=p,c=new RTCSessionDescription(o.offerObj),await i.setRemoteDescription(c),g=(m=null==m?await navigator.mediaDevices.getUserMedia(r):m).getTracks(),l=0,d=g.length;l<d;l++)h=g[l],i.addTrack(h,m);t=await i.createAnswer(),c=new RTCSessionDescription(t),await i.setLocalDescription(c),o={type:"audio-answer",sourceUUID:o.sourceUUID,targetUUID:o.targetUUID,answerObj:t},a=JSON.stringify(o),U(`sdp ${p} `+a)}"video-answer"===o.type&&(v("video-answer received"),f=o.targetUUID,i=w[f],c=new RTCSessionDescription(o.answerObj),await i.setRemoteDescription(c),v(" - > connection should be configured!")),"audio-answer"===o.type&&(v("audio-answer received"),f=o.targetUUID,i=w[f],c=new RTCSessionDescription(o.answerObj),await i.setRemoteDescription(c),v(" - > connection should be configured!")),"ice-candidate"===o.type&&(v("ice-candidate received"),n=new RTCIceCandidate(o.candidate),await(i=o.youAreTarget?y[o.sourceUUID]:w[o.targetUUID]).addIceCandidate(n),v(" - > added ICE Candidate"))}catch(e){v(e)}},D=function(e,t){switch(v("initiateConnection"),t){case"call":ce(e);break;case"video":se(e)}},me=Object.prototype.toString,B=Array.isArray||function(e){return"[object Array]"===me.call(e)};function I(e){return"function"==typeof e}function x(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function ye(e,t){return null!=e&&"object"==typeof e&&t in e}var we=RegExp.prototype.test,be=/\S/,Ue={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},Ce=/\s*/,ke=/\s+/,De=/\s*=/,Ie=/\s*\}/,Se=/#|\^|\/|>|\{|&|=|!/;function R(e){this.string=e,this.tail=e,this.pos=0}function S(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function T(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}R.prototype.eos=function(){return""===this.tail},R.prototype.scan=function(e){e=this.tail.match(e);if(!e||0!==e.index)return"";e=e[0];return this.tail=this.tail.substring(e.length),this.pos+=e.length,e},R.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},S.prototype.push=function(e){return new S(e,this)},S.prototype.lookup=function(e){var t,n,o,a=this.cache;if(a.hasOwnProperty(e))t=a[e];else{for(var i,r,c,s=this,l=!1;s;){if(0<e.indexOf("."))for(i=s.view,r=e.split("."),c=0;null!=i&&c<r.length;)c===r.length-1&&(l=ye(i,r[c])||(n=i,o=r[c],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(o))),i=i[r[c++]];else i=s.view[e],l=ye(s.view,e);if(l){t=i;break}s=s.parent}a[e]=t}return t=I(t)?t.call(this.view):t},T.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},T.prototype.parse=function(e,L){var t=this.templateCache,n=e+":"+(L||M.tags).join(":"),o=void 0!==t,a=o?t.get(n):void 0;return null==a&&(a=function(e){if(!e)return[];var t,n,o,a,i=!1,r=[],c=[],s=[],l=!1,u=!1,d="",p=0;function f(){if(l&&!u)for(;s.length;)delete c[s.pop()];else s=[];u=l=!1}function h(e){if("string"==typeof e&&(e=e.split(ke,2)),!B(e)||2!==e.length)throw new Error("Invalid tags: "+e);t=new RegExp(x(e[0])+"\\s*"),n=new RegExp("\\s*"+x(e[1])),o=new RegExp("\\s*"+x("}"+e[1]))}h(L||M.tags);for(var g,v,m,y,w,b,U=new R(e);!U.eos();){if(g=U.pos,m=U.scanUntil(t))for(var C=0,k=m.length;C<k;++C)a=y=m.charAt(C),we.call(be,a)?(i=u=!0,d+=" "):(s.push(c.length),d+=y),c.push(["text",y,g,g+1]),g+=1,"\n"===y&&(f(),d="",p=0,i=!1);if(!U.scan(t))break;if(l=!0,v=U.scan(Se)||"name",U.scan(Ce),"="===v?(m=U.scanUntil(De),U.scan(De),U.scanUntil(n)):"{"===v?(m=U.scanUntil(o),U.scan(Ie),U.scanUntil(n),v="&"):m=U.scanUntil(n),!U.scan(n))throw new Error("Unclosed tag at "+U.pos);if(w=">"==v?[v,m,g,U.pos,d,p,i]:[v,m,g,U.pos],p++,c.push(w),"#"===v||"^"===v)r.push(w);else if("/"===v){if(!(b=r.pop()))throw new Error('Unopened section "'+m+'" at '+g);if(b[1]!==m)throw new Error('Unclosed section "'+b[1]+'" at '+g)}else"name"===v||"{"===v||"&"===v?u=!0:"="===v&&h(m)}if(f(),b=r.pop())throw new Error('Unclosed section "'+b[1]+'" at '+U.pos);for(var D,I=function(e){for(var t,n,o=[],a=0,i=e.length;a<i;++a)(t=e[a])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(o.push(t),n=t));return o}(c),S=[],T=S,E=[],O=0,j=I.length;O<j;++O)switch((D=I[O])[0]){case"#":case"^":T.push(D),E.push(D),T=D[4]=[];break;case"/":E.pop()[5]=D[2],T=0<E.length?E[E.length-1][4]:S;break;default:T.push(D)}return S}(e),o&&t.set(n,a)),a},T.prototype.render=function(e,t,n,o){var a=this.getConfigTags(o),a=this.parse(e,a),t=t instanceof S?t:new S(t,void 0);return this.renderTokens(a,t,n,e,o)},T.prototype.renderTokens=function(e,t,n,o,a){for(var i,r,c,s="",l=0,u=e.length;l<u;++l)c=void 0,"#"===(r=(i=e[l])[0])?c=this.renderSection(i,t,n,o,a):"^"===r?c=this.renderInverted(i,t,n,o,a):">"===r?c=this.renderPartial(i,t,n,a):"&"===r?c=this.unescapedValue(i,t):"name"===r?c=this.escapedValue(i,t,a):"text"===r&&(c=this.rawValue(i)),void 0!==c&&(s+=c);return s},T.prototype.renderSection=function(e,t,n,o,a){var i=this,r="",c=t.lookup(e[1]);if(c){if(B(c))for(var s=0,l=c.length;s<l;++s)r+=this.renderTokens(e[4],t.push(c[s]),n,o,a);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)r+=this.renderTokens(e[4],t.push(c),n,o,a);else if(I(c)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(t.view,o.slice(e[3],e[5]),function(e){return i.render(e,t,n,a)}))&&(r+=c)}else r+=this.renderTokens(e[4],t,n,o,a);return r}},T.prototype.renderInverted=function(e,t,n,o,a){var i=t.lookup(e[1]);if(!i||B(i)&&0===i.length)return this.renderTokens(e[4],t,n,o,a)},T.prototype.indentPartial=function(e,t,n){for(var o=t.replace(/[^ \t]/g,""),a=e.split("\n"),i=0;i<a.length;i++)a[i].length&&(0<i||!n)&&(a[i]=o+a[i]);return a.join("\n")},T.prototype.renderPartial=function(e,t,n,o){if(n){var a,i,r,c=this.getConfigTags(o),s=I(n)?n(e[1]):n[e[1]];if(null!=s)return a=e[6],r=e[5],e=e[4],i=s,0==r&&e&&(i=this.indentPartial(s,e,a)),r=this.parse(i,c),this.renderTokens(r,t,n,i,o)}},T.prototype.unescapedValue=function(e,t){t=t.lookup(e[1]);if(null!=t)return t},T.prototype.escapedValue=function(e,t,n){n=this.getConfigEscape(n)||M.escape,t=t.lookup(e[1]);if(null!=t)return("number"==typeof t&&n===M.escape?String:n)(t)},T.prototype.rawValue=function(e){return e[1]},T.prototype.getConfigTags=function(e){return B(e)?e:e&&"object"==typeof e?e.tags:void 0},T.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!B(e)?e.escape:void 0};var E,Te,M={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){O.templateCache=e},get templateCache(){return O.templateCache}},O=new T;M.clearCache=function(){return O.clearCache()},M.parse=function(e,t){return O.parse(e,t)},M.render=function(e,t,n,o){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(B(a=e)?"array":typeof a)+'" was given as the first argument for mustache#render(template, view, partials)');var a;return O.render(e,t,n,o)},M.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return Ue[e]})},M.Scanner=R,M.Context=S,M.Writer=T;const Ee=M;({log:E,olog:Te}=r("chatframemodule"));var Oe,je,Le,Be=null,xe=null,j=[],Re=function(){E("initialize"),Me(),window.onhashchange=Me,chatInput.addEventListener("keydown",Ne),chatInput.addEventListener("blur",Pe),Be=peerDisplayTemplate.innerHTML,E(Be),xe=chatElementTemplate.innerHTML,E(xe)},Me=function(){E("locationHashChanged"),("#chat"===location.hash?Ve:Ae)()},Ne=function(e){13===e.keyCode&&chatInput.value&&(Je(),chatInput.value="")},Pe=function(e){chatInput.value&&(Je(),chatInput.value="")},Je=function(){var e=chatInput.value;U("to all "+e)},Ve=function(){E("pullChatIn"),document.body.style.height="100vh",document.body.style.overflow="hidden",chatframe.classList.add("here"),ae()},Ae=function(){E("pushChatOut"),document.body.style.height="auto",document.body.style.overflow="scroll",chatframe.classList.remove("here"),ie(),chatHistoryBlock.innerHTML="",peerDisplayBlock.innerHTML="",j=[]},ze=function(e){for(var t=0;!e.classList.contains("peer-display-element");)if(e=e.parentNode,3<++t)throw new Error("No nearby parent having class peer-display-element");return e.getAttribute("uuid")},He=function(e){E("peerCallClicked"),e=ze(e.target),E(e),D(e,"call")},We=function(e){E("peerVideoClicked"),e=ze(e.target),E(e),D(e,"video")},Qe=function(){for(var e,t="",n=0,o=j.length;n<o;n++)e=j[n],t+=Ee.render(xe,e);chatHistoryBlock.innerHTML=t},qe=function(e){for(var t,n,o,a,i,r,c,s,l="",u=0,d=e.length;u<d;u++)t={uuid:e[u]},l+=Ee.render(Be,t);for(peerDisplayBlock.innerHTML=l,null!=(c=peerDisplayBlock.querySelector(`[uuid='${C()}']`))&&c.classList.add("self"),o=0,i=(n=peerDisplayBlock.getElementsByClassName("peer-call-button")).length;o<i;o++)n[o].addEventListener("click",He);for(a=0,r=(s=peerDisplayBlock.getElementsByClassName("peer-video-button")).length;a<r;a++)s[a].addEventListener("click",We)},Ze=function(e){var t,n;E(e),t=""+(n=new Date).getHours(),n=""+n.getMinutes(),t.length<2&&(t="0"+t),n.length<2&&(n="0"+n),j.unshift({text:e,time:t+":"+n}),64<j.length&&(j.length=64),E(j.length),Qe()},$e={unbreaker:!0,websocketmodule:!0},_e=$e;for(Le in _e)_e[Le]&&(V[Le]=!0);({log:Oe,olog:je}=r("queryfieldmodule"));var Fe=function(){Oe("initialize")};const L={appstartupmodule:e,chatframemodule:a,configmodule:t,debugmodule:i,queryfieldmodule:c,statemodule:b,webrtcmodule:o,websocketmodule:n};var Xe,e=Ge(62);Ge.n(e)().initialize(),Ge.g.allModules=L,Xe=L.appstartupmodule.startUp,async function(){var t,n,e=function(){var e=[];for(n in L)null!=(t=L[n]).initialize&&e.push(t.initialize());return e}();await Promise.all(e),Xe()}()})()})()</script></body></html>